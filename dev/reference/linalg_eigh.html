<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Computes the eigenvalue decomposition of a complex Hermitian or real symmetric matrix. — linalg_eigh • torch</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Computes the eigenvalue decomposition of a complex Hermitian or real symmetric matrix. — linalg_eigh"><meta property="og:description" content="Letting  be  or ,
the eigenvalue decomposition of a complex Hermitian or real symmetric matrix
 is defined as"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-178883486-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-178883486-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">torch</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.6.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li class="dropdown-header">Tensors</li>
    <li>
      <a href="../articles/tensor-creation.html">Creating tensors</a>
    </li>
    <li>
      <a href="../articles/indexing.html">Indexing</a>
    </li>
    <li>
      <a href="../articles/tensor/index.html">Tensor class</a>
    </li>
    <li>
      <a href="../articles/serialization.html">Serialization</a>
    </li>
    <li class="dropdown-header">Datasets</li>
    <li>
      <a href="../articles/loading-data.html">Loading Data</a>
    </li>
    <li class="dropdown-header">Autograd</li>
    <li>
      <a href="../articles/using-autograd.html">Using autograd</a>
    </li>
    <li>
      <a href="../articles/extending-autograd.html">Extending autograd</a>
    </li>
    <li>
      <a href="../articles/python-to-r.html">Python models</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/examples/basic-autograd.html">basic-autograd</a>
    </li>
    <li>
      <a href="../articles/examples/basic-nn-module.html">basic-nn-module</a>
    </li>
    <li>
      <a href="../articles/examples/dataset.html">dataset</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mlverse/torch/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Computes the eigenvalue decomposition of a complex Hermitian or real symmetric matrix.</h1>
    <small class="dont-index">Source: <a href="https://github.com/mlverse/torch/blob/HEAD/R/linalg.R" class="external-link"><code>R/linalg.R</code></a></small>
    <div class="hidden name"><code>linalg_eigh.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Letting  be  or ,
the <strong>eigenvalue decomposition</strong> of a complex Hermitian or real symmetric matrix
 is defined as</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">linalg_eigh</span><span class="op">(</span><span class="va">A</span>, UPLO <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>A</dt>
<dd><p>(Tensor): tensor of shape <code>(*, n, n)</code> where <code>*</code> is zero or more batch dimensions
consisting of symmetric or Hermitian matrices.</p></dd>
<dt>UPLO</dt>
<dd><p>('L', 'U', optional): controls whether to use the upper or lower triangular part
of <code>A</code> in the computations. Default: <code>'L'</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list <code>(eigenvalues, eigenvectors)</code> which corresponds to  and  above.
<code>eigenvalues</code> will always be real-valued, even when <code>A</code> is complex.
It will also be ordered in ascending order.
<code>eigenvectors</code> will have the same dtype as <code>A</code> and will contain the eigenvectors as its columns.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" data-external="1"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><mi>Q</mi><mi mathvariant="normal">diag</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Λ</mi><mo stretchy="false">)</mo><msup><mi>Q</mi><mi>H</mi></msup><mpadded width="0px"><mrow><mspace width="2em"></mspace><mi>Q</mi><mo>∈</mo><msup><mi mathvariant="double-struck">K</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msup><mo separator="true">,</mo><mi mathvariant="normal">Λ</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow></mpadded></mrow><annotation encoding="application/x-tex">
A = Q \operatorname{diag}(\Lambda) Q^{H}\mathrlap{\qquad Q \in \mathbb{K}^{n \times n}, \Lambda \in \mathbb{R}^n}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">diag</span></span><span class="mopen">(</span><span class="mord">Λ</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span></span></span></span></span><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:1.015771em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mord"><span class="mspace" style="margin-right:2em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Λ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span class="fix"></span></span></span></span></span></span></span></span></p>
<p>where  is the conjugate transpose when  is complex, and the transpose when  is real-valued.
 is orthogonal in the real case and unitary in the complex case.</p>
<p>Supports input of float, double, cfloat and cdouble dtypes.
Also supports batches of matrices, and if <code>A</code> is a batch of matrices then
the output has the same batch dimensions.</p>
<p><code>A</code> is assumed to be Hermitian (resp. symmetric), but this is not checked internally, instead:</p><ul><li><p>If <code>UPLO</code>\ <code>= 'L'</code> (default), only the lower triangular part of the matrix is used in the computation.</p></li>
<li><p>If <code>UPLO</code>\ <code>= 'U'</code>, only the upper triangular part of the matrix is used.
The eigenvalues are returned in ascending order.</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>The eigenvalues of real symmetric or complex Hermitian matrices are always real.</p>
    </div>
    <div id="warning">
    <h2>Warning</h2>
    

<ul><li><p>The eigenvectors of a symmetric matrix are not unique, nor are they continuous with
respect to <code>A</code>. Due to this lack of uniqueness, different hardware and
software may compute different eigenvectors.
This non-uniqueness is caused by the fact that multiplying an eigenvector by
<code>-1</code> in the real case or by  in the complex
case produces another set of valid eigenvectors of the matrix.
This non-uniqueness problem is even worse when the matrix has repeated eigenvalues.
In this case, one may multiply the associated eigenvectors spanning
the subspace by a rotation matrix and the resulting eigenvectors will be valid
eigenvectors.</p></li>
<li><p>Gradients computed using the <code>eigenvectors</code> tensor will only be finite when
<code>A</code> has unique eigenvalues.
Furthermore, if the distance between any two eigvalues is close to zero,
the gradient will be numerically unstable, as it depends on the eigenvalues
 through the computation of
.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><code><a href="linalg_eigvalsh.html">linalg_eigvalsh()</a></code> computes only the eigenvalues values of a Hermitian matrix.
Unlike <code>linalg_eigh()</code>, the gradients of <code><a href="linalg_eigvalsh.html">linalg_eigvalsh()</a></code> are always
numerically stable.</p></li>
<li><p><code><a href="linalg_cholesky.html">linalg_cholesky()</a></code> for a different decomposition of a Hermitian matrix.
The Cholesky decomposition gives less information about the matrix but is much faster
to compute than the eigenvalue decomposition.</p></li>
<li><p><code><a href="linalg_eig.html">linalg_eig()</a></code> for a (slower) function that computes the eigenvalue decomposition
of a not necessarily Hermitian square matrix.</p></li>
<li><p><code><a href="linalg_svd.html">linalg_svd()</a></code> for a (slower) function that computes the more general SVD
decomposition of matrices of any shape.</p></li>
<li><p><code><a href="linalg_qr.html">linalg_qr()</a></code> for another (much faster) decomposition that works on general
matrices.</p></li>
</ul><p>Other linalg: 
<code><a href="linalg_cholesky_ex.html">linalg_cholesky_ex</a>()</code>,
<code><a href="linalg_cholesky.html">linalg_cholesky</a>()</code>,
<code><a href="linalg_det.html">linalg_det</a>()</code>,
<code><a href="linalg_eigvalsh.html">linalg_eigvalsh</a>()</code>,
<code><a href="linalg_eigvals.html">linalg_eigvals</a>()</code>,
<code><a href="linalg_eig.html">linalg_eig</a>()</code>,
<code><a href="linalg_householder_product.html">linalg_householder_product</a>()</code>,
<code><a href="linalg_inv_ex.html">linalg_inv_ex</a>()</code>,
<code><a href="linalg_inv.html">linalg_inv</a>()</code>,
<code><a href="linalg_lstsq.html">linalg_lstsq</a>()</code>,
<code><a href="linalg_matrix_norm.html">linalg_matrix_norm</a>()</code>,
<code><a href="linalg_matrix_power.html">linalg_matrix_power</a>()</code>,
<code><a href="linalg_matrix_rank.html">linalg_matrix_rank</a>()</code>,
<code><a href="linalg_multi_dot.html">linalg_multi_dot</a>()</code>,
<code><a href="linalg_norm.html">linalg_norm</a>()</code>,
<code><a href="linalg_pinv.html">linalg_pinv</a>()</code>,
<code><a href="linalg_qr.html">linalg_qr</a>()</code>,
<code><a href="linalg_slogdet.html">linalg_slogdet</a>()</code>,
<code><a href="linalg_solve.html">linalg_solve</a>()</code>,
<code><a href="linalg_svdvals.html">linalg_svdvals</a>()</code>,
<code><a href="linalg_svd.html">linalg_svd</a>()</code>,
<code><a href="linalg_tensorinv.html">linalg_tensorinv</a>()</code>,
<code><a href="linalg_tensorsolve.html">linalg_tensorsolve</a>()</code>,
<code><a href="linalg_vector_norm.html">linalg_vector_norm</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="torch_is_installed.html">torch_is_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="torch_randn.html">torch_randn</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">linalg_eigh</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.8444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.4095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{2} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.9990 -0.0456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0456 -0.9990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{2,2} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Falbel, Javier Luraschi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

